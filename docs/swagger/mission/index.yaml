openapi: 3.0.3
info:
  title: Mission API
  version: v1
  description: |
    Comprehensive API for managing educational missions and training opportunities.

    **Features:**
    - Mission creation with comprehensive validation and file upload support
    - Organization-based mission management with role-based access control
    - Multi-skill mission support with flexible input formats
    - Date and time scheduling with validation and ISO 8601 conversion
    - Mission status tracking throughout lifecycle
    - Technical document upload and management via Cloudinary
    - Educator invitation system with tracking
    - Organization-specific mission filtering and management

    **Authentication & Authorization:**
    - All endpoints require valid JWT authentication token
    - Mission creation and updates require organization role
    - Organization-specific endpoints require organization role
    - Educator-specific endpoints require educator role
    - Organization must exist before creating missions
    - Tokens obtained from Authentication API sign-in endpoint

    **Mission Lifecycle:**
    - `pending`: Newly created missions awaiting approval (default)
    - `ongoing`: Active missions in progress
    - `completed`: Successfully finished missions

    **File Upload Support:**
    - Technical documents (jpg, jpeg, png, gif, pdf)
    - Maximum file size: 5MB
    - Automatic file processing and Cloudinary storage
    - Files stored in missions/{organizationId}/technicalDocument folder

    **Educator Management:**
    - Track invited, hired, and rejected educators
    - Send bulk invitations to multiple educators
    - Cross-reference missions with educator profiles

  contact:
    name: API Support
    email: support@yourapi.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.yourapp.com
    description: Production server
  - url: https://romulus-backend.onrender.com
    description: Staging server
  - url: http://localhost:5000
    description: Development server

tags:
  - name: Mission Management
    description: Educational mission creation and management operations

components:
  schemas:
    # ================================
    # PRIMITIVE TYPES
    # ================================
    ID:
      type: string
      description: MongoDB ObjectId identifier
      example: "60d0fe4f5311236168a109ca"
      pattern: "^[0-9a-fA-F]{24}$"
      minLength: 24
      maxLength: 24

    Timestamp:
      type: string
      format: date-time
      description: ISO 8601 timestamp with timezone
      example: "2024-01-15T10:30:00.000Z"

    DocumentUrl:
      type: string
      description: URL or file path for uploaded technical documents from Cloudinary
      example: "https://res.cloudinary.com/dtipq9s09/image/upload/v1751048825/missions/60d0fe4f5311236168a109ca/technicalDocument.pdf"
      pattern: "^https?:\\/\\/.+\\.(jpg|jpeg|png|gif|pdf)$"

    MissionStatus:
      type: string
      enum: [pending, ongoing, completed]
      description: |
        Mission status throughout its lifecycle:
        - `pending`: Newly created mission awaiting approval (default)
        - `ongoing`: Active mission in progress
        - `completed`: Successfully finished mission
      default: pending
      example: pending

    TimeFormat:
      type: string
      description: Time in 24-hour HH:MM format
      example: "14:30"
      pattern: "^([01]?[0-9]|2[0-3]):[0-5][0-9]$"

    # ================================
    # RESPONSE STRUCTURES
    # ================================
    BaseResponse:
      type: object
      required:
        - success
        - message
      properties:
        success:
          type: boolean
          description: Indicates if the operation completed successfully
        message:
          type: string
          description: Human-readable response message
          example: "Operation completed successfully"

    ErrorResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: object
          properties:
            success:
              example: false
            message:
              example: "An error occurred processing your request"

    # ================================
    # ORGANIZATION REFERENCE SCHEMA
    # ================================
    OrganizationReference:
      type: object
      required:
        - _id
        - organizationName
        - city
        - country
      properties:
        _id:
          $ref: "#/components/schemas/ID"
        organizationName:
          type: string
          description: Name of the organization
          example: "Global Education Solutions"
        city:
          type: string
          description: Organization's city
          example: "Paris"
        country:
          type: string
          description: Organization's country
          example: "France"
        phone:
          type: string
          description: Organization's contact phone
          example: "+33123456789"
        branches:
          type: array
          description: Organization's branch locations
          items:
            type: object
            properties:
              branchName:
                type: string
                example: "Downtown Branch"
              branchEmail:
                type: string
                format: email
                example: "downtown@example.com"

    # ================================
    # MISSION SCHEMAS
    # ================================
    Mission:
      type: object
      required:
        - _id
        - organization
        - title
        - description
        - branch
        - skills
        - start
        - end
        - status
        - invitedEducators
        - hiredEducators
        - rejectedEducators
        - createdAt
        - updatedAt
      properties:
        _id:
          $ref: "#/components/schemas/ID"
        organization:
          oneOf:
            - $ref: "#/components/schemas/ID"
            - $ref: "#/components/schemas/OrganizationReference"
          description: Associated organization (ObjectId in create response, populated object in get responses)
        educator:
          $ref: "#/components/schemas/ID"
          description: Primary assigned educator (optional)
          nullable: true
        title:
          type: string
          description: Mission title or name
          example: "Advanced Mathematics Training Program"
          maxLength: 200
        description:
          type: string
          description: Detailed mission description
          example: "Comprehensive training program covering advanced mathematical concepts including calculus, linear algebra, and statistical analysis for secondary education professionals."
          maxLength: 2000
        branch:
          type: string
          description: Specific branch location for the mission
          example: "Downtown Branch"
          maxLength: 100
        skills:
          type: array
          description: Required skills for the mission
          items:
            type: string
            minLength: 1
          example: ["mathematics", "algebra", "calculus", "statistics"]
          minItems: 1
          maxItems: 20
        start:
          type: string
          format: date-time
          description: Mission start date and time in ISO 8601 format
          example: "2025-07-01T09:00:00.000Z"
        end:
          type: string
          format: date-time
          description: Mission end date and time in ISO 8601 format
          example: "2025-08-30T17:00:00.000Z"
        technicalDocument:
          $ref: "#/components/schemas/DocumentUrl"
          description: Technical documentation or requirements document stored in Cloudinary
          nullable: true
        status:
          $ref: "#/components/schemas/MissionStatus"
        invitedEducators:
          type: array
          description: Array of educator IDs invited to this mission
          items:
            $ref: "#/components/schemas/ID"
          default: []
        hiredEducators:
          type: array
          description: Array of educator IDs hired for this mission
          items:
            $ref: "#/components/schemas/ID"
          default: []
        rejectedEducators:
          type: array
          description: Array of educator IDs who rejected this mission
          items:
            $ref: "#/components/schemas/ID"
          default: []
        createdAt:
          $ref: "#/components/schemas/Timestamp"
        updatedAt:
          $ref: "#/components/schemas/Timestamp"

    # ================================
    # EDUCATOR-SPECIFIC SCHEMAS
    # ================================
    EducatorMissionView:
      type: object
      description: Mission data as seen by educators (excludes educator tracking arrays for privacy)
      required:
        - _id
        - organization
        - title
        - description
        - branch
        - skills
        - start
        - end
        - status
        - createdAt
        - updatedAt
      properties:
        _id:
          $ref: "#/components/schemas/ID"
        organization:
          $ref: "#/components/schemas/OrganizationReference"
          description: Populated organization object with full details
        educator:
          $ref: "#/components/schemas/ID"
          description: Primary assigned educator (optional)
          nullable: true
        title:
          type: string
          description: Mission title or name
          example: "Advanced Mathematics Training Program"
          maxLength: 200
        description:
          type: string
          description: Detailed mission description
          example: "Comprehensive training program covering advanced mathematical concepts including calculus, linear algebra, and statistical analysis for secondary education professionals."
          maxLength: 2000
        branch:
          type: string
          description: Specific branch location for the mission
          example: "Downtown Branch"
          maxLength: 100
        skills:
          type: array
          description: Required skills for the mission
          items:
            type: string
            minLength: 1
          example: ["mathematics", "algebra", "calculus", "statistics"]
          minItems: 1
          maxItems: 20
        start:
          type: string
          format: date-time
          description: Mission start date and time in ISO 8601 format
          example: "2025-07-01T09:00:00.000Z"
        end:
          type: string
          format: date-time
          description: Mission end date and time in ISO 8601 format
          example: "2025-08-30T17:00:00.000Z"
        technicalDocument:
          $ref: "#/components/schemas/DocumentUrl"
          description: Technical documentation or requirements document stored in Cloudinary
          nullable: true
        status:
          $ref: "#/components/schemas/MissionStatus"
        createdAt:
          $ref: "#/components/schemas/Timestamp"
        updatedAt:
          $ref: "#/components/schemas/Timestamp"
      # Note: invitedEducators, hiredEducators, rejectedEducators are explicitly excluded

    # ================================
    # REQUEST SCHEMAS
    # ================================
    MissionCreateRequest:
      type: object
      required:
        - organization
        - title
        - description
        - branch
        - skills
        - startDate
        - endDate
        - startTime
        - endTime
      properties:
        organization:
          $ref: "#/components/schemas/ID"
          description: ID of the organization creating the mission
        educator:
          $ref: "#/components/schemas/ID"
          description: Optional primary assigned educator
        title:
          type: string
          description: Mission title or name
          maxLength: 200
        description:
          type: string
          description: Detailed mission description
          maxLength: 2000
        branch:
          type: string
          description: Specific branch location for the mission
          maxLength: 100
        skills:
          type: string
          description: Required skills (comma-separated string)
          example: "mathematics,algebra,calculus,statistics"
        startDate:
          type: string
          format: date
          description: Mission start date (YYYY-MM-DD format)
          example: "2025-07-01"
        endDate:
          type: string
          format: date
          description: Mission end date (YYYY-MM-DD format)
          example: "2025-08-30"
        startTime:
          $ref: "#/components/schemas/TimeFormat"
          description: Daily start time for the mission
        endTime:
          $ref: "#/components/schemas/TimeFormat"
          description: Daily end time for the mission
        status:
          $ref: "#/components/schemas/MissionStatus"
          description: Optional mission status (defaults to pending)
        technicalDocument:
          type: string
          format: binary
          description: Technical documentation file (jpg, jpeg, png, gif, pdf, max 5MB)

    MissionUpdateRequest:
      type: object
      description: Partial update request - at least one field required
      properties:
        title:
          type: string
          description: Mission title or name
          maxLength: 200
        description:
          type: string
          description: Detailed mission description
          maxLength: 2000
        branch:
          type: string
          description: Specific branch location for the mission
          maxLength: 100
        startDate:
          type: string
          format: date
          description: Mission start date (YYYY-MM-DD format)
        endDate:
          type: string
          format: date
          description: Mission end date (YYYY-MM-DD format)
        startTime:
          $ref: "#/components/schemas/TimeFormat"
          description: Daily start time for the mission
        endTime:
          $ref: "#/components/schemas/TimeFormat"
          description: Daily end time for the mission
        status:
          $ref: "#/components/schemas/MissionStatus"
          description: Updated mission status

    InvitationRequest:
      type: object
      required:
        - missionId
        - invitees
      properties:
        missionId:
          $ref: "#/components/schemas/ID"
          description: ID of the mission to send invitations for
        invitees:
          type: array
          description: Array of educator IDs to invite
          items:
            $ref: "#/components/schemas/ID"
          minItems: 1
          example: ["60d0fe4f5311236168a109ca", "60d0fe4f5311236168a109cb"]

    # ================================
    # RESPONSE SCHEMAS
    # ================================
    MissionCreateData:
      type: object
      description: Mission data in create response (organization field as ObjectId)
      allOf:
        - $ref: "#/components/schemas/Mission"
        - type: object
          properties:
            organization:
              $ref: "#/components/schemas/ID"
              description: Associated organization ObjectId

    MissionCreateResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: object
          properties:
            data:
              $ref: "#/components/schemas/MissionCreateData"
          example:
            success: true
            message: "Mission created successfully"
            data:
              _id: "60d0fe4f5311236168a109ca"
              organization: "684a9654caa07bcde4138271"
              title: "Advanced Mathematics Training Program"
              description: "Comprehensive training program covering advanced mathematical concepts including calculus, linear algebra, and statistical analysis for secondary education professionals."
              branch: "Downtown Branch"
              skills: ["mathematics", "algebra", "calculus", "statistics"]
              start: "2025-07-01T09:00:00.000Z"
              end: "2025-08-30T17:00:00.000Z"
              technicalDocument: "https://res.cloudinary.com/dtipq9s09/image/upload/v1751048825/missions/684a9654caa07bcde4138271/technicalDocument.pdf"
              status: "pending"
              invitedEducators: []
              hiredEducators: []
              rejectedEducators: []
              createdAt: "2025-06-27T14:30:00.000Z"
              updatedAt: "2025-06-27T14:30:00.000Z"

    MissionListResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: object
          properties:
            data:
              type: array
              items:
                $ref: "#/components/schemas/Mission"
          example:
            success: true
            message: "Missions retrieved successfully"

    MissionSingleResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: object
          properties:
            data:
              $ref: "#/components/schemas/Mission"
          example:
            success: true
            message: "Mission retrieved successfully"

    MissionUpdateResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: object
          properties:
            data:
              $ref: "#/components/schemas/Mission"
          example:
            success: true
            message: "Mission updated successfully"

    EducatorMissionResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: object
          properties:
            data:
              $ref: "#/components/schemas/EducatorMissionView"

    InvitationResponse:
      allOf:
        - $ref: "#/components/schemas/BaseResponse"
        - type: object
          example:
            success: true
            message: "Invitations have been sent to 5 educators successfully."

  parameters:
    MissionIdPath:
      in: path
      name: id
      required: true
      description: MongoDB ObjectId of the mission
      schema:
        $ref: "#/components/schemas/ID"

    OrganizationIdPath:
      in: path
      name: id
      required: true
      description: MongoDB ObjectId of the organization
      schema:
        $ref: "#/components/schemas/ID"

    MissionIdPathParam:
      in: path
      name: mId
      required: true
      description: MongoDB ObjectId of the mission
      schema:
        $ref: "#/components/schemas/ID"

    OrganizationIdPathParam:
      in: path
      name: oId
      required: true
      description: MongoDB ObjectId of the organization
      schema:
        $ref: "#/components/schemas/ID"

    EducatorIdPath:
      in: path
      name: eId
      required: true
      description: MongoDB ObjectId of the educator
      schema:
        $ref: "#/components/schemas/ID"

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        JWT token obtained from the authentication sign-in endpoint.
        Include in the Authorization header as: `Bearer <token>`

  responses:
    # ================================
    # SUCCESS RESPONSES
    # ================================
    MissionCreateSuccess:
      description: Mission created successfully
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/MissionCreateResponse"

    MissionListSuccess:
      description: Missions list retrieved successfully
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/MissionListResponse"

    MissionProfileResponse:
      description: Mission retrieved successfully
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/MissionSingleResponse"
          example:
            success: true
            message: "Mission retrieved successfully"
            data:
              _id: "60d0fe4f5311236168a109ca"
              organization:
                _id: "684a9654caa07bcde4138271"
                organizationName: "Global Education Solutions"
                city: "Paris"
                country: "France"
                phone: "+33123456789"
                branches:
                  - branchName: "Downtown Branch"
                    branchEmail: "downtown@example.com"
              title: "Advanced Mathematics Training Program"
              description: "Comprehensive training program covering advanced mathematical concepts including calculus, linear algebra, and statistical analysis for secondary education professionals."
              branch: "Downtown Branch"
              skills: ["mathematics", "algebra", "calculus", "statistics"]
              start: "2025-07-01T09:00:00.000Z"
              end: "2025-08-30T17:00:00.000Z"
              technicalDocument: "https://res.cloudinary.com/dtipq9s09/image/upload/v1751048825/missions/684a9654caa07bcde4138271/technicalDocument.pdf"
              status: "ongoing"
              invitedEducators: ["60d0fe4f5311236168a109ca"]
              hiredEducators: []
              rejectedEducators: []
              createdAt: "2025-06-27T14:30:00.000Z"
              updatedAt: "2025-06-28T10:15:00.000Z"

    MissionUpdateSuccess:
      description: Mission updated successfully
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/MissionUpdateResponse"

    InvitationSuccess:
      description: Invitations sent successfully
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/InvitationResponse"

    # ================================
    # ERROR RESPONSES
    # ================================
    BadRequest:
      description: Invalid request data or business logic violation
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            validationError:
              summary: Field validation failed
              value:
                success: false
                message: "Title cannot exceed 200 characters"
            dateValidation:
              summary: Date/time validation failed
              value:
                success: false
                message: "Invalid date or time input."
            timeFormatError:
              summary: Time format validation failed
              value:
                success: false
                message: "Time must be in HH:MM format (24-hour)"
            skillsRequired:
              summary: Skills validation failed
              value:
                success: false
                message: "At least one skill is required"
            updateMinFields:
              summary: Update requires at least one field
              value:
                success: false
                message: "At least one field must be provided for update"

    Unauthorized:
      description: Authentication failed or invalid credentials
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            missingToken:
              summary: No authentication token provided
              value:
                success: false
                message: "Authorization token missing or malformed"
            invalidToken:
              summary: Token expired or malformed
              value:
                success: false
                message: "Invalid or expired token"

    Forbidden:
      description: Insufficient permissions for the operation
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            organizationRoleRequired:
              summary: Organization role required
              value:
                success: false
                message: "Access denied: organization role required"
            educatorRoleRequired:
              summary: Educator role required
              value:
                success: false
                message: "Access denied: educator role required"

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            organizationNotFound:
              summary: Associated organization not found
              value:
                success: false
                message: "Organization not found"
            missionNotFound:
              summary: Mission not found
              value:
                success: false
                message: "Mission not found"

    InternalServerError:
      description: Unexpected server error occurred
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          examples:
            missionCreationFailed:
              summary: Database operation failed
              value:
                success: false
                message: "Failed to create mission"
            missionUpdateFailed:
              summary: Database update operation failed
              value:
                success: false
                message: "Failed to update mission"

security:
  - BearerAuth: []

paths:
  /api/v1/missions:
    post:
      summary: Create new mission
      description: |
        Creates a new educational mission for an organization.

        **Prerequisites:**
        - Valid JWT authentication token
        - User must have organization role
        - Organization must exist in the system

        **File Upload Support:**
        - Content-Type: multipart/form-data
        - Technical document formats: jpg, jpeg, png, gif, pdf
        - Maximum file size: 5MB
        - Files are processed and stored with generated paths in Cloudinary
        - Files stored in missions/{organizationId}/technicalDocument folder

        **Date/Time Processing:**
        - Separate date and time inputs are combined into ISO 8601 format
        - startDate + startTime = start (ISO 8601)
        - endDate + endTime = end (ISO 8601)
        - Invalid date/time combinations throw validation errors

        **Validation Rules:**
        - Title: Max 200 characters
        - Description: Max 2000 characters
        - Branch: Max 100 characters
        - Skills: Comma-separated string, processed into array (1-20 skills)
        - Time format: HH:MM (24-hour)
        - Status: Defaults to "pending"

        **Business Logic:**
        - Validates organization existence
        - Processes skills from comma-separated string to array
        - Handles file upload for technical documents via Cloudinary
        - Initializes educator arrays as empty

      operationId: create-mission
      tags: [Mission Management]
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/MissionCreateRequest"
            examples:
              completeMission:
                summary: Complete mission with all fields
                value:
                  organization: "684a9654caa07bcde4138271"
                  title: "Advanced Mathematics Training Program"
                  description: "Comprehensive training program covering advanced mathematical concepts including calculus, linear algebra, and statistical analysis for secondary education professionals."
                  branch: "Downtown Branch"
                  skills: "mathematics,algebra,calculus,statistics"
                  startDate: "2025-07-01"
                  endDate: "2025-08-30"
                  startTime: "09:00"
                  endTime: "17:00"
              minimalMission:
                summary: Minimal required fields
                value:
                  organization: "684a9654caa07bcde4138271"
                  title: "Basic Science Workshop"
                  description: "Introduction to basic scientific principles for primary educators"
                  branch: "Main Branch"
                  skills: "science,biology"
                  startDate: "2025-08-15"
                  endDate: "2025-09-15"
                  startTime: "10:00"
                  endTime: "16:00"
      responses:
        201:
          $ref: "#/components/responses/MissionCreateSuccess"
        400:
          $ref: "#/components/responses/BadRequest"
        401:
          $ref: "#/components/responses/Unauthorized"
        403:
          $ref: "#/components/responses/Forbidden"
        404:
          $ref: "#/components/responses/NotFound"
        500:
          $ref: "#/components/responses/InternalServerError"

    get:
      summary: Get all missions
      description: |
        Retrieves all missions in the system with populated organization information.

        **Authentication:**
        - Requires valid JWT authentication token
        - No specific role requirement

        **Response Details:**
        - Returns array of all missions
        - Each mission includes populated organization object
        - Organization includes basic info and branch details
        - All document URLs and file paths are included
        - Educator arrays (invited, hired, rejected) are included
        - No pagination applied - returns all missions

        **Use Cases:**
        - Browse available missions
        - Admin dashboard for mission management
        - Mission discovery for educators
        - Analytics and reporting

      operationId: get-all-missions
      tags: [Mission Management]
      security:
        - BearerAuth: []
      responses:
        200:
          $ref: "#/components/responses/MissionListSuccess"
        401:
          $ref: "#/components/responses/Unauthorized"
        500:
          $ref: "#/components/responses/InternalServerError"

  /api/v1/missions/organization/{id}:
    get:
      summary: Get all missions for a specific organization
      description: |
        Retrieves all missions created by a specific organization.

        **Prerequisites:**
        - Valid JWT authentication token
        - User must have organization role

        **Response Details:**
        - Returns array of missions for the specified organization
        - Each mission includes populated organization object
        - All educator tracking arrays are included
        - Filtered by organization ID

        **Use Cases:**
        - Organization dashboard showing their missions
        - Organization-specific mission management
        - Track organization's mission history

      operationId: get-all-missions-by-organization
      tags: [Mission Management]
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/OrganizationIdPath"
      responses:
        200:
          $ref: "#/components/responses/MissionListSuccess"
        401:
          $ref: "#/components/responses/Unauthorized"
        403:
          $ref: "#/components/responses/Forbidden"
        500:
          $ref: "#/components/responses/InternalServerError"

  /api/v1/missions/{id}:
    get:
      summary: Get mission by ID
      description: |
        Retrieves a specific mission by its MongoDB ObjectId.

        **Authentication:**
        - Requires valid JWT authentication token
        - No specific role requirement

        **Response Details:**
        - Returns complete mission with populated organization information
        - Organization object includes name, location, contact details, and branches
        - All technical documents and file paths are included
        - Shows current mission status and scheduling details
        - Includes all educator tracking arrays

        **Use Cases:**
        - Display detailed mission information
        - Mission application process
        - Mission management and tracking
        - Educator mission evaluation

      operationId: get-mission-by-id
      tags: [Mission Management]
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/MissionIdPath"
      responses:
        200:
          $ref: "#/components/responses/MissionProfileResponse"
        401:
          $ref: "#/components/responses/Unauthorized"
        404:
          $ref: "#/components/responses/NotFound"
        500:
          $ref: "#/components/responses/InternalServerError"

    patch:
      summary: Update mission by ID
      description: |
        Updates an existing mission with partial data.

        **Prerequisites:**
        - Valid JWT authentication token
        - User must have organization role
        - Mission must exist in the system

        **Update Rules:**
        - At least one field must be provided for update
        - All validation rules apply to updated fields
        - File uploads supported for technical document updates
        - Uses findByIdAndUpdate with new: true and upsert: true

        **Date/Time Processing:**
        - If date/time fields are updated, they follow same conversion logic as creation
        - startDate + startTime combined into start field
        - endDate + endTime combined into end field

        **Validation:**
        - Same validation rules as creation apply to updated fields
        - Date/time format validation if dates/times are updated
        - Character limits apply to text fields

        **Business Logic:**
        - Mission must exist before update
        - File uploads replace existing technical documents
        - Status transitions are allowed based on mission lifecycle
        - Response includes updated mission data

      operationId: update-mission-by-id
      tags: [Mission Management]
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/MissionIdPath"
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/MissionUpdateRequest"
            examples:
              statusUpdate:
                summary: Update mission status
                value:
                  status: "ongoing"
              scheduleUpdate:
                summary: Update mission schedule
                value:
                  startDate: "2025-08-01"
                  endDate: "2025-09-30"
                  startTime: "08:30"
                  endTime: "16:30"
              partialUpdate:
                summary: Update multiple fields
                value:
                  title: "Updated Mission Title"
                  description: "Updated comprehensive mission description"
                  status: "ongoing"
      responses:
        200:
          $ref: "#/components/responses/MissionUpdateSuccess"
        400:
          $ref: "#/components/responses/BadRequest"
        401:
          $ref: "#/components/responses/Unauthorized"
        403:
          $ref: "#/components/responses/Forbidden"
        404:
          $ref: "#/components/responses/NotFound"
        500:
          $ref: "#/components/responses/InternalServerError"

  /api/v1/missions/{mId}/organization/{oId}:
    get:
      summary: Get specific mission by organization
      description: |
        Retrieves a specific mission for a specific organization by mission ID and organization ID.

        **Prerequisites:**
        - Valid JWT authentication token
        - User must have organization role

        **Response Details:**
        - Returns single mission object with populated organization
        - **INCLUDES all educator arrays (invited, hired, rejected) for organization management**
        - Shows complete mission details for organization dashboard

        **Use Cases:**
        - Organization viewing their mission details
        - Organization managing educator assignments
        - Track educator status for mission planning

      operationId: get-mission-by-organization
      tags: [Mission Management]
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/MissionIdPathParam"
        - $ref: "#/components/parameters/OrganizationIdPathParam"
      responses:
        200:
          $ref: "#/components/responses/MissionProfileResponse"
        401:
          $ref: "#/components/responses/Unauthorized"
        403:
          $ref: "#/components/responses/Forbidden"
        404:
          $ref: "#/components/responses/NotFound"
        500:
          $ref: "#/components/responses/InternalServerError"

  /api/v1/missions/{mId}/educator/{eId}:
    get:
      summary: Get mission by educator association
      description: |
        Retrieves a specific mission where the educator is involved (invited, hired, or rejected).

        **Prerequisites:**
        - Valid JWT authentication token
        - User must have educator role

        **Search Logic:**
        - Uses $or query to find missions where educator ID appears in:
          - invitedEducators array
          - hiredEducators array  
          - rejectedEducators array
        - Returns first matching mission with specified mission ID

        **Response Details:**
        - Returns single mission object with populated organization
        - **EXCLUDES educator tracking arrays (invitedEducators, hiredEducators, rejectedEducators) for privacy**
        - Educator can see mission details but not other educators involved

        **Use Cases:**
        - Educator viewing their assigned/invited missions
        - Check mission details for specific educator-mission relationship
        - Mission status tracking for educators

      operationId: get-mission-by-educator-association
      tags: [Mission Management]
      security:
        - BearerAuth: []
      parameters:
        - $ref: "#/components/parameters/MissionIdPathParam"
        - $ref: "#/components/parameters/EducatorIdPath"
      responses:
        200:
          description: Mission retrieved successfully (educator view - excludes educator arrays)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EducatorMissionResponse"
              example:
                success: true
                message: "Mission retrieved successfully"
                data:
                  _id: "60d0fe4f5311236168a109ca"
                  organization:
                    _id: "684a9654caa07bcde4138271"
                    organizationName: "Global Education Solutions"
                    city: "Paris"
                    country: "France"
                    phone: "+33123456789"
                    branches:
                      - branchName: "Downtown Branch"
                        branchEmail: "downtown@example.com"
                  educator: "60d0fe4f5311236168a109ca"
                  title: "Advanced Mathematics Training Program"
                  description: "Comprehensive training program covering advanced mathematical concepts including calculus, linear algebra, and statistical analysis for secondary education professionals."
                  branch: "Downtown Branch"
                  skills: ["mathematics", "algebra", "calculus", "statistics"]
                  start: "2025-07-01T09:00:00.000Z"
                  end: "2025-08-30T17:00:00.000Z"
                  technicalDocument: "https://res.cloudinary.com/dtipq9s09/image/upload/v1751048825/missions/684a9654caa07bcde4138271/technicalDocument.pdf"
                  status: "ongoing"
                  createdAt: "2025-06-27T14:30:00.000Z"
                  updatedAt: "2025-06-28T10:15:00.000Z"
        401:
          $ref: "#/components/responses/Unauthorized"
        403:
          $ref: "#/components/responses/Forbidden"
        404:
          $ref: "#/components/responses/NotFound"
        500:
          $ref: "#/components/responses/InternalServerError"

  /api/v1/missions/send-invitations:
    post:
      summary: Send mission invitations to educators
      description: |
        Sends invitations for a specific mission to multiple educators.

        **Prerequisites:**
        - Valid JWT authentication token
        - User must have organization role
        - Mission and all educator IDs must be valid

        **Business Logic:**
        - Updates mission's invitedEducators array with provided educator IDs
        - Updates each educator's missionsInvitedFor array with mission info
        - Sets invitation status to "pending" for all invitations
        - Uses $push operator to add mission invitation to educator profiles

        **Bulk Operations:**
        - Processes multiple educator invitations in a single request
        - Updates both mission and educator records
        - Returns count of successful invitations sent

        **Use Cases:**
        - Bulk invite educators to missions
        - Organization recruiting process
        - Mission staffing management
        - Educator opportunity distribution

      operationId: send-mission-invitations
      tags: [Mission Management]
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InvitationRequest"
            examples:
              singleInvitation:
                summary: Send invitation to one educator
                value:
                  missionId: "60d0fe4f5311236168a109ca"
                  invitees: ["60d0fe4f5311236168a109cb"]
              multipleInvitations:
                summary: Send invitations to multiple educators
                value:
                  missionId: "60d0fe4f5311236168a109ca"
                  invitees:
                    [
                      "60d0fe4f5311236168a109cb",
                      "60d0fe4f5311236168a109cc",
                      "60d0fe4f5311236168a109cd",
                      "60d0fe4f5311236168a109ce",
                      "60d0fe4f5311236168a109cf",
                    ]
      responses:
        200:
          $ref: "#/components/responses/InvitationSuccess"
        400:
          $ref: "#/components/responses/BadRequest"
        401:
          $ref: "#/components/responses/Unauthorized"
        403:
          $ref: "#/components/responses/Forbidden"
        404:
          $ref: "#/components/responses/NotFound"
        500:
          $ref: "#/components/responses/InternalServerError"
